*PHP過濾器(filter)用來清理/淨化和驗證不安全/不合法來源的資料，例如使用者輸入*

*淨化就是刪除/跳脫外部輸入不合法或是不安全的字元*

*驗證可以確保外部輸入是你所期望的資料*

*永遠不要相信使用者的輸入，始終對外部資料進行過濾及驗證*

*`filter_var()`和 `filter_input()`可以過濾文字及驗證文字格式*

*使用內建的 `htmlspecialchars()` 過濾，預設只轉化雙引號，不對單引號做轉義*

*`htmlspecialchars($string, ENT_QUOTES)` 這樣做會更好*

*`htmlentities()`並不適用中文，因為會連同中文字一起轉義*

*`htmlspecialchars()`和 `htmlentities()`只能防止XSS攻擊，不能防止SQL隱碼攻擊*

*外部資料*

- 表單的輸入資料
- Cookie / Session
- 資料庫查詢結果
- 伺服器變數
- 上傳及下載的檔案
- 第三方服務提供的資料

*PHP過濾器*
- Sanitizing: 過濾字串中允許或禁止的指定字元
- Validating: 用於驗證使用者輸入

***

*PHP變數過濾器*

*`filter_has_var()` 檢查是否存在指定輸入類別的變數*
*`filter_var()` 指定過濾器來過濾單一變數*
*`filter_var_array()` 通過相同或不相同的過濾器來過濾多個變數*
*`filter_input()` 過濾輸入變數*
*`filter_input_array()` 通過相同或不相同的過濾器來過濾多個輸入變數*

*PHP清理/淨化/消毒過濾器*

*`FILTER_SANITIZE_EMAIL` 過濾Email，刪除E-mail格式不該出現的字元*
*`FILTER_SANITIZE_STRING` 去除標籤或特殊字元*
*`FILTER_SANITIZE_URL` 過濾URL，刪除URL格式不該出現的字元*
*`FILTER_SANITIZE_NUMBER_INT` 刪除所有非數字字元，保留數字和+-符號*
*`FILTER_SANITIZE_NUMBER_FLOAT`*
*`FILTER_SANITIZE_SPECIAL_CHARS`*
*`FILTER_SANITIZE_MAGIC_QUOTES`*

*PHP驗證過濾器*

*`FILTER_VALIDATE_EMAIL` 驗證是否為合法E-mail格式*
*`FILTER_VALIDATE_INT` 驗證是否為數字*
*`FILTER_VALIDATE_FLOAT` 驗證是否為浮點數*
*`FILTER_VALIDATE_BOOLEAN` 驗證是否為布林值*
*`FILTER_VALIDATE_IP` 驗證是否為合法IP*
*`FILTER_VALIDATE_URL` 驗證是否為合法網址*
*`FILTER_VALIDATE_REGEXP` 利用正規式做驗證*

***

*數值驗證*
```
if(!filter_var(1022,FILTER_VALIDATE_INT)) echo 'int is invalid';
```

*數值範圍驗證*
```
$options=array('options'=>array('min_range'=>0,'max_range'=>255));
if(filter_var(256,FILTER_VALIDATE_INT),$options) echo 'int is invalid';
```

*清理驗證使用者輸入的電子信箱*
```
if(filter_has_var(INPUT_GET,'email')){
	filter_input(INPUT_GET,'email',FILTER_SANITIZE_EMAIL);
	if(!filter_input(INPUT_GET,'email',FILTER_VALIDATE_EMAIL))
		echo 'invalid email address';
}
```

*淨化(刪除非法字元)使用者輸入資料*
```
if(filter_has_var(INPUT_POST,'url')){
	$url=filter_input(INPUT_POST,'url',FILTER_SANITIZE_URL);
}
```

*清理字符串*
```
$sanitize=filter_var($string,FILTER_SANITIZE_STRING);
```

*清理驗證網址* 
```
$url=filter_var($url,FILTER_SANITIZE_URL);
if(!filter_var($url,FILTER_VALIDATE_URL)) echo 'invalid url';
```

*IPV4驗證*
```
if(!filter_var($ip,FILTER_VALIDATE_IP,FILTER_FLAG_IPV4)) echo 'invalid IP';
```

*IPV6驗證*
```
if(!filter_var($ip,FILTER_VALIDATE_IP,FILTER_FLAG_IPV6)) echo 'invalid IP';
```